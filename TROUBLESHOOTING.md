# Решение проблем с загрузкой изображений в игре

## Проблема
Не удается загрузить фотографию для игры в приложении "Пятнашки".

## Причины и решения

### 1. Django-сервер не запущен
**Симптомы:** Ошибка "Не удается подключиться к серверу"

**Решение:**
```bash
cd service1
python manage.py runserver
```

### 2. React-приложение не запущено
**Симптомы:** Страница игры не загружается

**Решение:**
```bash
cd src
npm start
```

### 3. Проблемы с CORS
**Симптомы:** Ошибки в консоли браузера о CORS

**Решение:**
- Убедитесь, что установлен `django-cors-headers`
- Проверьте настройки CORS в `service1/service1_project/settings.py`
- Перезапустите Django-сервер

### 4. Проблемы с авторизацией
**Симптомы:** Ошибка "Необходимо войти в систему"

**Решение:**
- Войдите в систему через Django-приложение
- Убедитесь, что сессия активна

### 5. Проблемы с правами доступа к папке media
**Симптомы:** Ошибка "Ошибка сервера" при загрузке

**Решение:**
- Проверьте, что папка `service1/media/game_images/` существует
- Убедитесь, что у Django есть права на запись в эту папку

## Тестирование

### Тест загрузки изображений
1. Откройте файл `test_upload.html` в браузере
2. Выберите изображение
3. Проверьте, что оно загружается на сервер

### Тест в игре
1. Запустите Django-сервер
2. Запустите React-приложение
3. Войдите в систему
4. Попробуйте загрузить изображение в игре

## Логи и отладка

### Django логи
```bash
cd service1
tail -f clickhouse.log
```

### Консоль браузера
- Откройте Developer Tools (F12)
- Перейдите на вкладку Console
- Ищите ошибки JavaScript

### Сетевые запросы
- Откройте Developer Tools (F12)
- Перейдите на вкладку Network
- Попробуйте загрузить изображение
- Проверьте статус запроса к `/accounts/api/upload-image/`

## Структура файлов

```
service1/
├── media/
│   └── game_images/          # Папка для загруженных изображений
├── accounts/
│   ├── views.py              # API для загрузки изображений
│   └── urls.py               # URL маршруты
└── service1_project/
    └── settings.py           # Настройки CORS

src/
├── components/
│   ├── ImageUploader.js      # Компонент загрузки изображений
│   └── Game.js               # Основной компонент игры
└── utils/
    └── imageUtils.js         # Утилиты для работы с изображениями
```

## Частые ошибки

### "Failed to fetch"
- Django-сервер не запущен
- Неправильный URL в fetch запросе
- Проблемы с CORS

### "Unauthorized"
- Пользователь не авторизован
- Сессия истекла
- Проблемы с cookies

### "File too large"
- Размер файла превышает 10 МБ
- Увеличьте лимит в `upload_image_api` view

### "Invalid file type"
- Файл не является изображением
- Неподдерживаемый формат
- Проверьте `allowed_types` в Django view

## Контакты для поддержки

Если проблемы не решаются, проверьте:
1. Версии Python и Django
2. Логи ошибок
3. Настройки браузера
4. Сетевые настройки
